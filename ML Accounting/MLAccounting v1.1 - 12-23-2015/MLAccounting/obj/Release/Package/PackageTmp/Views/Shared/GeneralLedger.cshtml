@model Accounting.Models.GLReportViewModel

<span style="font-size:10px;">
    <b> General Ledger Listing as of @Model.periodTo</b>
</span>
<br />
<span style="font-size:8px;">
    @Model.Corporate
</span>
<br />
<br />

<table>
    <tr>
        <td>
            @*<img height="50%" width="225" src="@Accounting.UrlHelperExtension.ResolveServerUrl(VirtualPathUtility.ToAbsolute("~/Content/images/logored.png"), false)" />*@
            @*<img height="50%" width="225" src="http://192.168.16.104:81/Content/images/logored.png" />*@
            @{
                string logoPath = String.Format("{0}{1}{2}{3}{4}", Request.Url.Scheme.Trim(),
                    System.Uri.SchemeDelimiter.Trim(),
                    Request.Url.Host.Trim(),
                    (Request.Url.IsDefaultPort ? "" : ":" + Request.Url.Port).Trim(),
                    Url.Content("~/Content/images/logored.png"));

                    <img height="50%" width="225" src="@logoPath" />
            }
        </td>
        <td width="60%">
            <table style="font-size:10px;" border="1">
                <tbody>
                    <tr>
                        <td width="20%">
                            Branch
                        </td>
                        <td>
                            @Model.BranchCode @Model.BranchName
                        </td>
                    </tr>
                    <tr>
                        <td width="20%">
                            G/L listing for account
                        </td>
                        <td>
                            [@Model.GeneralLedger.GeneralLedger] to [@Model.GeneralLedger.GeneralLedger]
                        </td>
                    </tr>
                    <tr>
                        <td width="20%">
                            for fiscal period
                        </td>
                        <td>
                            [@Convert.ToDateTime(Model.periodFrom).Month] to [@Convert.ToDateTime(Model.periodTo).Month]
                        </td>
                    </tr>
                    <tr>
                        <td>
                            sorted by
                        </td>
                        <td>
                            (Account)
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>        
    </tr>
</table>

<span style="font-size:9px;"><i> (Exclude) accounts with no activity</i></span>
<br />
<br />
<table style="font-size:8px;" border="1">
    <thead>
        <tr>
            <td width="10%">Account</td>
            <td width="5%">Dept.</td>
            <td width="80%"></td>
        </tr>
    </thead>
</table>


<table style="font-size:8px;" border="1">
    <thead>
        <tr>
            <td width="2%"></td>
            <td width="3%">Pd</td>
            <td width="5%">Srce</td>
            <td width="7%">Date</td>
            <td width="20%">Description</td>
            <td width="15%">Reference</td>
            <td width="10%" align="center">Debits</td>
            <td width="10%" align="center">Credit</td>
            <td width="10%" align="center">Net Change</td>
            <td width="10%" align="center">Balance</td>
        </tr>
    </thead>
</table>
<br />
<table style="font-size:8px;">
    <tbody>
        <tr>
            <td width="10%">
                @Model.GeneralLedger.GeneralLedger
            </td>
            <td width="5%">
                @Model.BranchCode
            </td>
            <td width="80%">
                @Model.GeneralLedger.Description - @Model.BranchName
            </td>
            <td width="10%" align="right">
                @Model.GLBeginningBalance.ToString("#,#00.00;(#,#00.00)")
            </td>
        </tr>
        <tr> <td colspan="2"></td> </tr>
        <tr> <td colspan="2"></td> </tr>
        <tr> <td colspan="2"></td> </tr>
    </tbody>
</table>

<table style="font-size:8px;">
    <tbody>
        @foreach (var item in Model.GLEntrys)
        {
            <tr>
                <td width="2%"></td>
                <td width="3%" align="right" valign="top">@Convert.ToDateTime(item.date).Month</td>
                <td width="5%" valign="top">GL-JE</td>
                <td width="7%" valign="top">@Convert.ToDateTime(item.date).ToString("MMM dd yy")</td>
                <td width="20%" valign="top">@item.Remarks</td>
                <td width="15%" valign="top">@item.Reference</td>
                <td width="10%" align="right" valign="bottom">
                    @if (item.Debit != 0)
                    {
                        @item.Debit.ToString("#,#00.00");
                    }
                </td>
                <td width="10%" align="right" valign="bottom">
                    @if (item.Credit != 0)
                    {
                        @Math.Abs(item.Credit).ToString("#,#00.00");
                    }
                </td>
                <td width="10%" align="right" valign="bottom">
                    @if (item.isLastDayOfMonth == 0)
                    {
                        @item.NetChange.ToString("#,#00.00;(#,#00.00)");
                    }
                </td>
                <td width="10%" align="right" valign="bottom">
                    @if (item.isLastDayOfMonth == 0)
                    {
                        @item.BeginningBalance.ToString("#,#00.00;(#,#00.00)");
                    }
                </td>
            </tr>
        }
        <tr>
            <td colspan="6"></td>
            <td>_____________</td>
            <td>_____________</td>
            <td></td>
            <td>_____________ </td>
        </tr>
        <tr>
            <td colspan="6"></td>
            <td align="right">
                @Model.GLEntrys.Sum(m => m.Debit).ToString("#,#00.00")
            </td>
            <td align="right">
                @Math.Abs(Model.GLEntrys.Sum(m => m.Credit)).ToString("#,#00.00")
            </td>
            <td></td>
            <td align="right">@Model.GLEntrys.Select(m => m.BeginningBalance).LastOrDefault().ToString("#,#00.00;(#,#00.00)")</td>
        </tr>
        <tr>
            <td colspan="6"></td>
            <td>
                <span style="text-decoration:underline">
                    <b>_____________</b>
                </span>
            </td>
            <td>
                <span style="text-decoration:underline">
                    <b>_____________</b>
                </span>
            </td>
            <td></td>
            <td>
                <span style="text-decoration:underline">
                    <b>_____________</b>
                </span>
            </td>
        </tr>
    </tbody>
</table>